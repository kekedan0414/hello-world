# 【redis】

基于k-v的内存数据库，一般在业务系统中数据量较大的交互时，做缓存使用，加快响应速度，提升用户体验。

### redis是单线程的？

连接池：存放多个socket的list或者数组集合。 
redis是的工作线程是单线程的，主要使用的是epoll的多路复用，一个线程处理多个socket。
服务器接收客户端数据，通过socket连接。
服务端先创建一个socket，bind绑定端口，listen监听socket，然后accept等待客户端连接，accept会阻塞（线程挂起，放弃CPU资源），等待客户端连接。（客户端创建socket，connect连接）
（服务器有两个socket，一个监听socket，一个通讯socket）
 早期：一个线程处理一个socket。但线程占用资源，线程太多影响性能。

### redis缓存击穿问题

缓存击穿表示恶意用户模拟请求很多缓存中不存在的数据，由于缓存中都没有，导致这些请求短时间内直接落在了数据库上，导致数据库异常。
解决方案：数据库访问排队上锁，即根据key获取value值为空时，锁上，从数据库中load数据后再释放锁。

### redis雪崩

缓存在同一时间内大量k-v过期（失效），接着来的一大波请求瞬间都落在了数据库中导致连接异常。
解决方案：
方案1、也是像解决缓存穿透一样加锁排队，实现同上;
方案2、建立备份缓存，缓存A和缓存B，A设置超时时间，B不设值超时时间，先从A读缓存，A没有读B，并且更新A缓存和B缓存;